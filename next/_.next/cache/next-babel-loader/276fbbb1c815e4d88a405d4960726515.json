{"ast":null,"code":"var _jsxFileName = \"/Users/webthomaz/Desktop/Desenvolvimento/m/monka/monka-api/next/components/Pages/Addresses/form.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { Form, Button, Row, Col } from 'react-bootstrap';\nimport { useRouter } from 'next/router';\nimport { withFormik } from 'formik';\nimport * as Yup from 'yup';\nimport { toast } from 'react-toastify';\nimport { useEffect, useState } from 'react';\nimport Select from 'react-select';\nimport { withRouter } from 'next/router';\nimport Spinner from '../../Spinner';\nimport Loading from '../../Loading';\nimport { get, patch, post } from '../../../services/http';\n\nfunction ChangePasswordForm(props) {\n  const router = useRouter();\n  const {\n    0: neighborhoods,\n    1: setNeighborhoods\n  } = useState([]);\n  useEffect(() => {\n    if (props.status && props.status.success) {\n      toast.success('Salvo com sucesso!', {\n        position: toast.POSITION.BOTTOM_CENTER\n      });\n      router.push('/account/addresses');\n    }\n  }, [props.status]);\n  useEffect(() => {\n    async function getNeighborhoods() {\n      const result = await get('/neighborhood');\n      const data = result.map(neighborhood => {\n        return {\n          label: neighborhood.name,\n          value: neighborhood.id\n        };\n      });\n      setNeighborhoods(data);\n    }\n\n    getNeighborhoods();\n  }, [props.router]);\n  useEffect(() => {\n    async function getNeighborhood() {\n      if (props.router.query.id && neighborhoods.length > 0) {\n        const result = await get(`/myAddress/${props.router.query.id}`);\n        const neighborhood = neighborhoods.find(item => item.value === result.neighborhood_id);\n        props.setFieldValue('id', result.id);\n        props.setFieldValue('street', result.street);\n        props.setFieldValue('number', result.number);\n        props.setFieldValue('complement', result.complement || '');\n        props.setFieldValue('neighborhood_id', neighborhood);\n      }\n    }\n\n    getNeighborhood();\n  }, [neighborhoods]);\n  if (neighborhoods.length <= 0) return __jsx(Loading, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60\n    },\n    __self: this\n  });\n  return __jsx(Form, {\n    onSubmit: props.handleSubmit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63\n    },\n    __self: this\n  }, __jsx(Row, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64\n    },\n    __self: this\n  }, __jsx(Col, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65\n    },\n    __self: this\n  }, __jsx(Form.Group, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66\n    },\n    __self: this\n  }, __jsx(Form.Label, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67\n    },\n    __self: this\n  }, \"Cidade\"), __jsx(Form.Control, {\n    value: \"Cascavel PR\",\n    disabled: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68\n    },\n    __self: this\n  }))), __jsx(Col, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71\n    },\n    __self: this\n  }, __jsx(Form.Group, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72\n    },\n    __self: this\n  }, __jsx(Form.Label, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73\n    },\n    __self: this\n  }, \"Bairro\"), __jsx(Select, {\n    options: neighborhoods,\n    placeholder: \"Selecione o Bairro\",\n    value: props.values.neighborhood_id,\n    onChange: value => props.setFieldValue('neighborhood_id', value),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74\n    },\n    __self: this\n  }), props.touched.neighborhood_id && props.errors.neighborhood_id && __jsx(Form.Control.Feedback, {\n    type: \"invalid\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81\n    },\n    __self: this\n  }, props.errors.neighborhood_id)))), __jsx(Row, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87\n    },\n    __self: this\n  }, __jsx(Col, {\n    xs: 8,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88\n    },\n    __self: this\n  }, __jsx(Form.Group, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89\n    },\n    __self: this\n  }, __jsx(Form.Label, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90\n    },\n    __self: this\n  }, \"Rua\"), __jsx(Form.Control, {\n    onChange: e => props.setFieldValue('street', e.target.value),\n    value: props.values.street,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91\n    },\n    __self: this\n  }), props.touched.street && props.errors.street && __jsx(Form.Control.Feedback, {\n    type: \"invalid\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96\n    },\n    __self: this\n  }, props.errors.street))), __jsx(Col, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100\n    },\n    __self: this\n  }, __jsx(Form.Group, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101\n    },\n    __self: this\n  }, __jsx(Form.Label, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102\n    },\n    __self: this\n  }, \"N\\xBA\"), __jsx(Form.Control, {\n    type: \"number\",\n    onChange: e => props.setFieldValue('number', e.target.value),\n    value: props.values.number,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103\n    },\n    __self: this\n  }), props.touched.number && props.errors.number && __jsx(Form.Control.Feedback, {\n    type: \"invalid\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109\n    },\n    __self: this\n  }, props.errors.number)))), __jsx(Form.Group, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115\n    },\n    __self: this\n  }, __jsx(Form.Label, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116\n    },\n    __self: this\n  }, \"Complemento\"), __jsx(Form.Control, {\n    as: \"textarea\",\n    rows: \"3\",\n    value: props.values.complement,\n    onChange: e => props.setFieldValue('complement', e.target.value),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117\n    },\n    __self: this\n  }), props.touched.complement && props.errors.complement && __jsx(Form.Control.Feedback, {\n    type: \"invalid\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124\n    },\n    __self: this\n  }, props.errors.complement)), __jsx(\"div\", {\n    className: \"mt-3 mb-5 d-flex justify-content-end\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128\n    },\n    __self: this\n  }, __jsx(\"button\", {\n    className: \"btn btn-primary\",\n    type: \"submit\",\n    disabled: props.isSubmitting,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129\n    },\n    __self: this\n  }, \"Salvar\", __jsx(\"i\", {\n    className: \"fas fa-disk\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131\n    },\n    __self: this\n  }), props.isSubmitting && __jsx(Spinner, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132\n    },\n    __self: this\n  }))));\n}\n\nexport default withFormik({\n  mapPropsToValues: props => ({\n    id: '',\n    street: '',\n    number: '',\n    neighborhood_id: {},\n    complement: ''\n  }),\n  validationSchema: Yup.object().shape({\n    street: Yup.string().required('Informe uma nova senha'),\n    number: Yup.number().required('Informe o número').positive('Digite apenas número').integer('Digite apenas número'),\n    neighborhood_id: Yup.object().required('Selecione o bairro')\n  }),\n  handleSubmit: async (values, {\n    setSubmitting,\n    setErrors,\n    setStatus\n  }) => {\n    try {\n      setSubmitting(true);\n\n      if (!values.neighborhood_id.value) {\n        return setErrors({\n          neighborhood_id: 'Selecione o bairro'\n        });\n      }\n\n      let result;\n\n      if (values.id) {\n        result = await patch(`/myAddress/${values.id}`, _objectSpread({}, values, {\n          neighborhood_id: values.neighborhood_id.value\n        }));\n      } else {\n        result = await post(`/myAddress`, _objectSpread({}, values, {\n          neighborhood_id: values.neighborhood_id.value\n        }));\n      }\n\n      if (result.success) {\n        setSubmitting(false);\n        setStatus({\n          success: true\n        });\n      }\n\n      if (result.validations) {\n        result.validations.map(e => {\n          let error = {};\n          error[e.field] = e.message;\n          setErrors(error);\n        });\n      }\n    } catch (error) {\n      console.log(error);\n      setErrors({\n        error: 'Não foi possível salvar. Tente novamente.'\n      });\n    }\n  }\n})(withRouter(ChangePasswordForm));","map":{"version":3,"sources":["/Users/webthomaz/Desktop/Desenvolvimento/m/monka/monka-api/next/components/Pages/Addresses/form.js"],"names":["Form","Button","Row","Col","useRouter","withFormik","Yup","toast","useEffect","useState","Select","withRouter","Spinner","Loading","get","patch","post","ChangePasswordForm","props","router","neighborhoods","setNeighborhoods","status","success","position","POSITION","BOTTOM_CENTER","push","getNeighborhoods","result","data","map","neighborhood","label","name","value","id","getNeighborhood","query","length","find","item","neighborhood_id","setFieldValue","street","number","complement","handleSubmit","values","touched","errors","e","target","isSubmitting","mapPropsToValues","validationSchema","object","shape","string","required","positive","integer","setSubmitting","setErrors","setStatus","validations","error","field","message","console","log"],"mappings":"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","sourcesContent":["import { Form, Button, Row, Col } from 'react-bootstrap';\nimport { useRouter } from 'next/router';\nimport { withFormik } from 'formik';\nimport * as Yup from 'yup';\nimport { toast } from 'react-toastify';\nimport { useEffect, useState } from 'react';\nimport Select from 'react-select';\nimport { withRouter } from 'next/router'\n\nimport Spinner from '../../Spinner';\nimport Loading from '../../Loading';\n\nimport { get, patch, post } from '../../../services/http';\n\nfunction ChangePasswordForm(props) {\n    const router = useRouter();\n    const [neighborhoods, setNeighborhoods] = useState([]);\n    \n    useEffect(() => {\n        if (props.status && props.status.success) {\n            toast.success('Salvo com sucesso!', {\n                position: toast.POSITION.BOTTOM_CENTER\n            });\n\n            router.push('/account/addresses');\n        }\n    }, [props.status])\n\n    useEffect(() => {\n        async function getNeighborhoods() {\n            const result = await get('/neighborhood');\n            const data = result.map(neighborhood => {\n                return { label: neighborhood.name, value: neighborhood.id }\n            });\n\n            setNeighborhoods(data);\n        }\n      \n        getNeighborhoods();\n    }, [props.router]);\n\n    useEffect(() => {\n        async function getNeighborhood() {\n            if (props.router.query.id && neighborhoods.length > 0) {\n                const result = await get(`/myAddress/${props.router.query.id}`);\n\n                const neighborhood = neighborhoods.find(item => item.value === result.neighborhood_id);\n\n                props.setFieldValue('id', result.id);\n                props.setFieldValue('street', result.street);\n                props.setFieldValue('number', result.number);\n                props.setFieldValue('complement', result.complement || '');\n                props.setFieldValue('neighborhood_id', neighborhood);\n            }\n        }\n\n        getNeighborhood();\n    }, [neighborhoods]);\n\n    if (neighborhoods.length <= 0) return <Loading />;\n\n    return (\n        <Form onSubmit={props.handleSubmit}>\n            <Row>\n                <Col>\n                    <Form.Group>\n                        <Form.Label>Cidade</Form.Label>\n                        <Form.Control value=\"Cascavel PR\" disabled />\n                    </Form.Group>                        \n                </Col>\n                <Col>\n                    <Form.Group>\n                        <Form.Label>Bairro</Form.Label>\n                        <Select\n                            options={neighborhoods}\n                            placeholder=\"Selecione o Bairro\"\n                            value={props.values.neighborhood_id}\n                            onChange={value => props.setFieldValue('neighborhood_id', value)}\n                        />\n                        {props.touched.neighborhood_id && props.errors.neighborhood_id && \n                            <Form.Control.Feedback type=\"invalid\">{props.errors.neighborhood_id}</Form.Control.Feedback>\n                        }\n                    </Form.Group>                        \n                </Col>\n            </Row>\n\n            <Row>\n                <Col xs={8}>\n                    <Form.Group>\n                        <Form.Label>Rua</Form.Label>\n                        <Form.Control \n                            onChange={e => props.setFieldValue('street', e.target.value)}\n                            value={props.values.street}\n                        />\n                        {props.touched.street && props.errors.street && \n                            <Form.Control.Feedback type=\"invalid\">{props.errors.street}</Form.Control.Feedback>\n                        }\n                    </Form.Group>                        \n                </Col>\n                <Col>\n                    <Form.Group>\n                        <Form.Label>Nº</Form.Label>\n                        <Form.Control \n                            type=\"number\"\n                            onChange={e => props.setFieldValue('number', e.target.value)}\n                            value={props.values.number}\n                        />\n                        {props.touched.number && props.errors.number && \n                            <Form.Control.Feedback type=\"invalid\">{props.errors.number}</Form.Control.Feedback>\n                        }\n                    </Form.Group>\n                </Col>\n            </Row>\n\n            <Form.Group>\n                <Form.Label>Complemento</Form.Label>\n                <Form.Control \n                    as=\"textarea\"\n                    rows=\"3\" \n                    value={props.values.complement}\n                    onChange={e => props.setFieldValue('complement', e.target.value)}\n                />\n                {props.touched.complement && props.errors.complement && \n                    <Form.Control.Feedback type=\"invalid\">{props.errors.complement}</Form.Control.Feedback>\n                }                        \n            </Form.Group>\n\n            <div className=\"mt-3 mb-5 d-flex justify-content-end\">\n                <button className=\"btn btn-primary\" type=\"submit\" disabled={props.isSubmitting}>\n                    Salvar  \n                    <i className=\"fas fa-disk\"></i> \n                    {props.isSubmitting && <Spinner />}\n                </button>\n            </div>\n        </Form>\n    );\n    \n}\n\nexport default withFormik({\n    mapPropsToValues: props => ({ \n        id: '', \n        street: '', \n        number: '', \n        neighborhood_id: {}, \n        complement: ''\n    }),\n  \n    validationSchema: Yup.object().shape({\n        street: Yup.string().required('Informe uma nova senha'),\n        number: Yup.number().required('Informe o número').positive('Digite apenas número').integer('Digite apenas número'),\n        neighborhood_id: Yup.object().required('Selecione o bairro'),\n    }),\n  \n    handleSubmit: async (values, { setSubmitting, setErrors, setStatus }) => {\n        try {\n            setSubmitting(true);\n\n            if (!values.neighborhood_id.value) {\n                return setErrors({ neighborhood_id:  'Selecione o bairro' });\n            }\n            \n            let result;\n            if (values.id) {\n                result = await patch(`/myAddress/${values.id}`, {\n                    ...values,\n                    neighborhood_id: values.neighborhood_id.value\n                });\n            } else {\n                result = await post(`/myAddress`, {\n                    ...values,\n                    neighborhood_id: values.neighborhood_id.value\n                });\n            }\n\n            if (result.success) {\n                setSubmitting(false);\n                setStatus({ success: true });\n            }\n    \n            if (result.validations) {\n                result.validations.map(e => {\n                    let error = {};\n                    error[e.field] = e.message;\n                    setErrors(error);\n                });\n            }\n  \n        } catch(error) {\n            console.log(error)\n            setErrors({ error: 'Não foi possível salvar. Tente novamente.' });\n        }\n    },\n  \n  })(withRouter(ChangePasswordForm));\n  \n  "]},"metadata":{},"sourceType":"module"}