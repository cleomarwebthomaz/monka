{"ast":null,"code":"var _jsxFileName = \"/Users/webthomaz/Desktop/Desenvolvimento/m/monka/monka-api/next/components/Cart/index.js\";\nvar __jsx = React.createElement;\nimport React, { useState, useEffect } from 'react';\nimport { ButtonGroup, ListGroup, Form, Spinner, Row, Col, Image, Card, Button } from 'react-bootstrap';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { useRouter } from 'next/router';\nimport { toast } from 'react-toastify';\nimport CheckoutComponent from './Checkout';\nimport currency from '../../utils/currency';\nimport { showCart, loadCart } from '../../store/actions/cart';\nimport { get, patch, httpDelete } from '../../services/http';\nimport './styles.scss';\n\nfunction CartComponent() {\n  const {\n    0: addresses,\n    1: setAddresses\n  } = useState([]);\n  const {\n    0: addressSelected,\n    1: setAddressSelected\n  } = useState({});\n  const route = useRouter();\n  const dispatch = useDispatch();\n  const {\n    isLogged\n  } = useSelector(state => state.auth);\n  const {\n    show,\n    cart,\n    loading\n  } = useSelector(state => state.cart);\n  const {\n    0: openCheckout,\n    1: setOpenCheckout\n  } = useState(false);\n  useEffect(() => {\n    async function getAddresses() {\n      const result = await get('/myAddress');\n\n      if (result.length <= 0) {\n        toast.warning('Adicione um endereço para continuar', {\n          position: toast.POSITION.BOTTOM_CENTER\n        });\n        dispatch(showCart(false));\n        return route.push('/auth/access/register-address');\n      }\n\n      if (!addressSelected || !addressSelected.id) {\n        const addressDefault = result.find(item => item.is_default);\n        setAddressSelected(addressDefault);\n      }\n\n      setAddresses(result);\n    }\n\n    if (isLogged && show) getAddresses();\n  }, [isLogged, show]);\n\n  async function deleteItem(cartProduct) {\n    await httpDelete(`/cart/${cartProduct.cart_id}/product/${cartProduct.id}`);\n    dispatch(loadCart());\n  }\n\n  async function setAddress(address) {\n    setAddressSelected(address);\n    await patch(`/myAddress/set-default/${address.id}`, address);\n    dispatch(loadCart());\n  }\n\n  async function incrementQuantity(cartProduct) {\n    cartProduct.quantity += 1;\n    await patch(`/cart/${cart.id}/product/${cartProduct.id}`, {\n      quantity: cartProduct.quantity\n    });\n    dispatch(loadCart());\n  }\n\n  async function decrementQuantity(cartProduct) {\n    cartProduct.quantity -= 1;\n\n    if (cartProduct.quantity <= 0) {\n      cartProduct.quantity = 1;\n    }\n\n    await patch(`/cart/${cart.id}/product/${cartProduct.id}`, {\n      quantity: cartProduct.quantity\n    });\n    dispatch(loadCart());\n  }\n\n  async function deleteItem(cartProduct) {\n    await httpDelete(`/cart/${cart.id}/product/${cartProduct.id}`);\n    dispatch(loadCart());\n  }\n\n  if (!show) return __jsx(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80\n    },\n    __self: this\n  });\n  return __jsx(React.Fragment, null, __jsx(\"div\", {\n    onClick: () => dispatch(showCart(false)),\n    className: \"cart-mask\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84\n    },\n    __self: this\n  }), __jsx(CheckoutComponent, {\n    show: openCheckout && cart.products.length > 0,\n    onHide: () => setOpenCheckout(),\n    addressSelected: addressSelected,\n    addresses: addresses,\n    cart: cart,\n    cartLoading: loading,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86\n    },\n    __self: this\n  }), __jsx(\"div\", {\n    id: \"block-cart\",\n    className: \"shadow\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"cart-header p-2 d-flex align-items-center border-bottom shadow justify-content-between\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"d-flex align-items-center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98\n    },\n    __self: this\n  }, __jsx(\"h4\", {\n    className: \"m-0 mr-1 text-light text-primary\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99\n    },\n    __self: this\n  }, \"Sua sacola\"), \"(\", cart.products.length, \") produto\", cart.products <= 1 ? '' : 's'), __jsx(\"button\", {\n    className: \"btn btn-light rounded-circle\",\n    onClick: () => {\n      dispatch(showCart(false));\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105\n    },\n    __self: this\n  }, __jsx(\"i\", {\n    className: \"fas fa-times\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110\n    },\n    __self: this\n  }))), __jsx(\"div\", {\n    className: \"body p-4 border-bottom\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114\n    },\n    __self: this\n  }, cart.products.length <= 0 && __jsx(\"div\", {\n    className: \"text-center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117\n    },\n    __self: this\n  }, __jsx(\"h1\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118\n    },\n    __self: this\n  }, \"Sua sacola est\\xE1 vazia\"), __jsx(\"div\", {\n    className: \"mt-5 empty-icon\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119\n    },\n    __self: this\n  }, __jsx(\"i\", {\n    className: \"far fa-frown-open\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120\n    },\n    __self: this\n  }))), cart.products.map(cartProduct => __jsx(Card, {\n    className: \"rounded position-relative mb-4 pt-1 pb-2 item border-0\",\n    key: cartProduct.id,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126\n    },\n    __self: this\n  }, __jsx(Row, {\n    key: cartProduct.id,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127\n    },\n    __self: this\n  }, __jsx(Col, {\n    xs: 4,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128\n    },\n    __self: this\n  }, __jsx(Image, {\n    src: cartProduct.product.image_url,\n    className: \"img-fluid\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129\n    },\n    __self: this\n  })), __jsx(Col, {\n    xs: 8,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132\n    },\n    __self: this\n  }, __jsx(\"h6\", {\n    className: \"text-primary mb-0 mt-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133\n    },\n    __self: this\n  }, cartProduct.product.name), __jsx(Row, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135\n    },\n    __self: this\n  }, __jsx(Col, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137\n    },\n    __self: this\n  }, __jsx(\"b\", {\n    className: \"group-name text-secondary mb-0\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137\n    },\n    __self: this\n  }, \"Tamanho\")), cartProduct.option && __jsx(\"div\", {\n    className: \"group-value\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138\n    },\n    __self: this\n  }, cartProduct.option.name)), __jsx(Col, {\n    sm: 6,\n    className: \"pr-5 mt-4 mt-sm-0\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"p-2 bg-light d-flex flex-column text-center block-quantity\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143\n    },\n    __self: this\n  }, __jsx(Button, {\n    className: \"btn-quantity border-0 left btn-sm rounded-circle\",\n    onClick: () => {\n      decrementQuantity(cartProduct);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144\n    },\n    __self: this\n  }, __jsx(\"i\", {\n    className: \"fas fa-minus-circle\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147\n    },\n    __self: this\n  })), __jsx(\"div\", {\n    className: \"quantity btn btn-sm border-sm pl-3 pr-3 rounded-0 text-dark\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149\n    },\n    __self: this\n  }, cartProduct.quantity || 1), __jsx(Button, {\n    className: \"btn-quantity border-0 right btn-sm rounded-circle\",\n    onClick: () => {\n      incrementQuantity(cartProduct);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152\n    },\n    __self: this\n  }, __jsx(\"i\", {\n    className: \"fas fa-plus-circle\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155\n    },\n    __self: this\n  }))), __jsx(\"div\", {\n    className: \"total_price text-success mt-1\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159\n    },\n    __self: this\n  }, __jsx(\"b\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160\n    },\n    __self: this\n  }, currency(cartProduct.total_price)))))), __jsx(Row, {\n    className: \"p-0 groups\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167\n    },\n    __self: this\n  }, cartProduct.groups.map(group => __jsx(Col, {\n    xs: 6,\n    key: group.id,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169\n    },\n    __self: this\n  }, __jsx(ListGroup, {\n    className: \"mb-2 list-groups\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170\n    },\n    __self: this\n  }, __jsx(ListGroup.Item, {\n    className: \"p-0 m-0 border-0 group-option\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171\n    },\n    __self: this\n  }, group.name), group.options.map(groupOption => __jsx(ListGroup.Item, {\n    className: \"p-0 m-0 border-0 group-option-name\",\n    key: groupOption.id,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176\n    },\n    __self: this\n  }, \"- \", groupOption.option.name, \" +\", __jsx(\"span\", {\n    className: \"text-muted\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178\n    },\n    __self: this\n  }, currency(groupOption.option.price))))))))), __jsx(Button, {\n    variant: \"danger\",\n    size: \"sm\",\n    className: \"rounded-circle btn-trash\",\n    onClick: () => {\n      deleteItem(cartProduct);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187\n    },\n    __self: this\n  }, __jsx(\"i\", {\n    className: \"fas fa-trash\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195\n    },\n    __self: this\n  })))))), __jsx(\"div\", {\n    className: \"footer w-100 pt-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"addresses ml-3 mr-3 mb-4\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204\n    },\n    __self: this\n  }, addresses.map(address => __jsx(Form.Group, {\n    key: address.id,\n    controlId: `address-${address.id}`,\n    className: \"mb-0\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206\n    },\n    __self: this\n  }, __jsx(Form.Check, {\n    type: \"radio\",\n    value: address.id,\n    checked: addressSelected && addressSelected.id === address.id,\n    label: `\n                                    ${address.street}, ${address.number} - \n                                    ${address.neighborhood.name} \n                                `,\n    onChange: () => setAddress(address),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207\n    },\n    __self: this\n  })))), __jsx(ListGroup, {\n    className: \"shadow ml-3 mr-3 mb-4 border-0\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221\n    },\n    __self: this\n  }, __jsx(ListGroup.Item, {\n    className: \"d-flex justify-content-between\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223\n    },\n    __self: this\n  }, \"Total de Items\"), __jsx(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226\n    },\n    __self: this\n  }, loading ? __jsx(Spinner, {\n    animation: \"border\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227\n    },\n    __self: this\n  }) : currency(cart.total_products))), __jsx(ListGroup.Item, {\n    className: \"d-flex justify-content-between\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 231\n    },\n    __self: this\n  }, \"Taxa de Entrega\"), __jsx(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234\n    },\n    __self: this\n  }, loading ? __jsx(Spinner, {\n    animation: \"border\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235\n    },\n    __self: this\n  }) : currency(cart.shipping)))), __jsx(\"div\", {\n    className: \"d-flex flex-column\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 240\n    },\n    __self: this\n  }, __jsx(ButtonGroup, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"btn btn-light btn-lg rounded-0\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 242\n    },\n    __self: this\n  }, \"Total: \", currency(cart.total_price)), __jsx(\"button\", {\n    className: \"btn btn-success btn-lg rounded-0\",\n    onClick: () => setOpenCheckout(true),\n    disabled: cart.products.length <= 0,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246\n    },\n    __self: this\n  }, \"Finalizar Pedido\", __jsx(\"i\", {\n    className: \"fas fa-chevron-right\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252\n    },\n    __self: this\n  })))))));\n}\n\nexport default CartComponent;","map":{"version":3,"sources":["/Users/webthomaz/Desktop/Desenvolvimento/m/monka/monka-api/next/components/Cart/index.js"],"names":["React","useState","useEffect","ButtonGroup","ListGroup","Form","Spinner","Row","Col","Image","Card","Button","useSelector","useDispatch","useRouter","toast","CheckoutComponent","currency","showCart","loadCart","get","patch","httpDelete","CartComponent","addresses","setAddresses","addressSelected","setAddressSelected","route","dispatch","isLogged","state","auth","show","cart","loading","openCheckout","setOpenCheckout","getAddresses","result","length","warning","position","POSITION","BOTTOM_CENTER","push","id","addressDefault","find","item","is_default","deleteItem","cartProduct","cart_id","setAddress","address","incrementQuantity","quantity","decrementQuantity","products","map","product","image_url","name","option","total_price","groups","group","options","groupOption","price","street","number","neighborhood","total_products","shipping"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { ButtonGroup, ListGroup, Form, Spinner, Row, Col, Image, Card, Button } from 'react-bootstrap';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { useRouter } from 'next/router';\nimport { toast } from 'react-toastify';\n\nimport CheckoutComponent from './Checkout';\n\nimport currency from '../../utils/currency';\nimport { showCart, loadCart } from '../../store/actions/cart';\nimport { get, patch, httpDelete } from '../../services/http';\nimport './styles.scss';\n\nfunction CartComponent() {\n    const [addresses, setAddresses] = useState([]);\n    const [addressSelected, setAddressSelected] = useState({});\n\n    const route = useRouter();\n    const dispatch = useDispatch();\n    const { isLogged } = useSelector(state => state.auth);\n    const { show, cart, loading } = useSelector(state => state.cart);\n    const [openCheckout, setOpenCheckout] = useState(false);\n\n    useEffect(() => {\n        async function getAddresses() {\n            const result = await get('/myAddress');\n\n            if (result.length <= 0) {\n                toast.warning('Adicione um endereço para continuar', { position: toast.POSITION.BOTTOM_CENTER });\n\n                dispatch(showCart(false));\n                return route.push('/auth/access/register-address')\n            }\n\n            if (!addressSelected || !addressSelected.id) {\n                const addressDefault = result.find(item => item.is_default);\n                setAddressSelected(addressDefault);\n            }\n\n            setAddresses(result);\n        } \n\n        if (isLogged && show) getAddresses();\n    }, [isLogged, show]);\n\n    async function deleteItem(cartProduct) {\n        await httpDelete(`/cart/${cartProduct.cart_id}/product/${cartProduct.id}`);\n        dispatch(loadCart());\n    }\n\n    async function setAddress(address) {\n        setAddressSelected(address);\n        await patch(`/myAddress/set-default/${address.id}`, address);\n        dispatch(loadCart());\n    }\n\n    async function incrementQuantity(cartProduct) {\n        cartProduct.quantity += 1;\n  \n        await patch(`/cart/${cart.id}/product/${cartProduct.id}`, { quantity: cartProduct.quantity });\n        dispatch(loadCart());\n    }\n  \n    async function decrementQuantity(cartProduct) {\n        cartProduct.quantity -= 1;\n  \n        if (cartProduct.quantity <= 0) {\n          cartProduct.quantity = 1;\n        }\n  \n        await patch(`/cart/${cart.id}/product/${cartProduct.id}`, { quantity: cartProduct.quantity });\n        dispatch(loadCart());\n    }\n  \n    async function deleteItem(cartProduct) {\n      await httpDelete(`/cart/${cart.id}/product/${cartProduct.id}`);\n      dispatch(loadCart());\n    }    \n\n    if (!show) return <div />;\n\n    return (\n        <>\n        <div onClick={() => dispatch(showCart(false)) } className=\"cart-mask\"></div>\n\n        <CheckoutComponent\n            show={openCheckout && cart.products.length > 0}\n            onHide={() => setOpenCheckout()}\n            addressSelected={addressSelected}\n            addresses={addresses}\n            cart={cart}\n            cartLoading={loading}\n        />\n\n        <div id=\"block-cart\" className=\"shadow\">\n            <div className=\"cart-header p-2 d-flex align-items-center border-bottom shadow justify-content-between\">\n\n                <div className=\"d-flex align-items-center\">\n                    <h4 className=\"m-0 mr-1 text-light text-primary\">\n                        Sua sacola\n                    </h4>\n                    ({cart.products.length}) produto{cart.products <= 1 ? '' : 's'}\n                </div>\n\n                <button className=\"btn btn-light rounded-circle\"\n                    onClick={() => {\n                        dispatch(showCart(false));\n                    }}\n                >\n                    <i className=\"fas fa-times\"></i>\n                </button>\n            </div>\n\n            <div className=\"body p-4 border-bottom\">\n\n                {cart.products.length <= 0 && \n                    <div className=\"text-center\"> \n                        <h1>Sua sacola está vazia</h1>\n                        <div className=\"mt-5 empty-icon\">\n                            <i className=\"far fa-frown-open\"></i>\n                        </div>\n                    </div>\n                }\n\n                {cart.products.map(cartProduct =>\n                    <Card className=\"rounded position-relative mb-4 pt-1 pb-2 item border-0\" key={cartProduct.id}>\n                        <Row key={cartProduct.id}>\n                            <Col xs={4}>\n                                <Image src={cartProduct.product.image_url} className=\"img-fluid\" />\n                            </Col>\n\n                            <Col xs={8}>\n                                <h6 className=\"text-primary mb-0 mt-3\">{cartProduct.product.name}</h6>\n\n                                <Row>\n                                    <Col>\n                                        <div><b className=\"group-name text-secondary mb-0\">Tamanho</b></div>\n                                        {cartProduct.option && <div className=\"group-value\">{cartProduct.option.name}</div>}\n                                    </Col>\n\n                                    <Col sm={6} className=\"pr-5 mt-4 mt-sm-0\">\n                                        <div className=\"p-2 bg-light d-flex flex-column text-center block-quantity\">\n                                            <div>\n                                                <Button className=\"btn-quantity border-0 left btn-sm rounded-circle\" onClick={() => {\n                                                    decrementQuantity(cartProduct);\n                                                }}>\n                                                    <i className=\"fas fa-minus-circle\"></i>\n                                                </Button>\n                                                <div className=\"quantity btn btn-sm border-sm pl-3 pr-3 rounded-0 text-dark\">\n                                                    {cartProduct.quantity || 1}\n                                                </div>\n                                                <Button className=\"btn-quantity border-0 right btn-sm rounded-circle\" onClick={() => {\n                                                    incrementQuantity(cartProduct);\n                                                }}>\n                                                    <i className=\"fas fa-plus-circle\"></i>\n                                                </Button>                                        \n                                            </div>\n\n                                            <div className=\"total_price text-success mt-1\">\n                                                <b>{currency(cartProduct.total_price)}</b>\n                                            </div>\n                                        </div>\n                                    </Col>\n\n                                </Row>\n\n                                <Row className=\"p-0 groups\">\n                                    {cartProduct.groups.map(group => \n                                        <Col xs={6} key={group.id}>\n                                            <ListGroup className=\"mb-2 list-groups\">\n                                                <ListGroup.Item className=\"p-0 m-0 border-0 group-option\">\n                                                    {group.name}\n                                                </ListGroup.Item>\n\n                                                {group.options.map(groupOption => \n                                                    <ListGroup.Item className=\"p-0 m-0 border-0 group-option-name\" key={groupOption.id}>\n                                                        - {groupOption.option.name} + \n                                                        <span className=\"text-muted\">{currency(groupOption.option.price)}</span>\n                                                    </ListGroup.Item>\n                                                )}\n                                            </ListGroup>\n                                        </Col>\n                                    )}\n                                </Row>                                \n                            </Col>\n\n                            <Button \n                                variant=\"danger\"\n                                size=\"sm\"\n                                className=\"rounded-circle btn-trash\"\n                                onClick={() => {\n                                    deleteItem(cartProduct);\n                                }}\n                            >\n                                <i className=\"fas fa-trash\"></i>\n                            </Button>\n                        </Row>\n                    </Card>\n                )}\n            </div>\n\n            <div className=\"footer w-100 pt-3\">\n\n                <div className=\"addresses ml-3 mr-3 mb-4\">\n                    {addresses.map(address => \n                        <Form.Group key={address.id} controlId={`address-${address.id}`} className=\"mb-0\">\n                            <Form.Check \n                                type=\"radio\" \n                                value={address.id}\n                                checked={addressSelected && addressSelected.id === address.id}\n                                label={`\n                                    ${address.street}, ${address.number} - \n                                    ${address.neighborhood.name} \n                                `} \n                                onChange={() => setAddress(address)}\n                            />\n                        </Form.Group>\n                    )}                    \n                </div>\n\n                <ListGroup className=\"shadow ml-3 mr-3 mb-4 border-0\">\n                    <ListGroup.Item className=\"d-flex justify-content-between\">\n                        <div>\n                            Total de Items \n                        </div>\n                        <div>\n                            {loading ? <Spinner animation=\"border\" /> : currency(cart.total_products)}\n                        </div>\n                    </ListGroup.Item>\n                    <ListGroup.Item className=\"d-flex justify-content-between\">\n                        <div>\n                            Taxa de Entrega \n                        </div>\n                        <div>\n                            {loading ? <Spinner animation=\"border\" /> : currency(cart.shipping)}\n                        </div>\n                    </ListGroup.Item>\n                </ListGroup>\n\n                <div className=\"d-flex flex-column\">\n                    <ButtonGroup>\n                        <div className=\"btn btn-light btn-lg rounded-0\">\n                            Total: {currency(cart.total_price)}\n                        </div>\n\n                        <button className=\"btn btn-success btn-lg rounded-0\" \n                            onClick={() => \n                            setOpenCheckout(true)} \n                            disabled={cart.products.length <= 0}\n                        >\n                            Finalizar Pedido  \n                            <i className=\"fas fa-chevron-right\"></i> \n                        </button>\n\n                    </ButtonGroup>\n                </div>\n            </div>\n        </div>\n        </>\n    );\n}\n\nexport default CartComponent;\n"]},"metadata":{},"sourceType":"module"}